以下のプルリクエストに対して、Chrome Extension に特化したセキュリティレビューを日本語で実施し、詳細なフィードバックを提供してください。

PR URL: $ARGS

まず、`gh pr view $ARGS` と `gh pr diff $ARGS` を使用してプルリクエストの詳細と変更内容を確認してください。

## レビュー観点

### 1. manifest.json のセキュリティ設定
- **permissions**: 最小権限の原則に従っているか
- **host_permissions**: 必要最小限のホストのみに制限されているか
- **Content Security Policy (CSP)**: 適切に設定されているか（特に `script-src`, `object-src` など）
- **externally_connectable**: 外部からの接続が適切に制限されているか
- **web_accessible_resources**: 公開リソースが最小限に抑えられているか

### 2. Content Scripts のセキュリティ
- **XSS対策**: ユーザー入力や外部データの適切なサニタイゼーション
- **DOM操作**: `innerHTML` などの危険な操作を避けているか
- **動的スクリプト実行**: `eval()`, `Function()` などの使用を避けているか
- **信頼できないコンテンツの処理**: ウェブページからのデータを適切に検証しているか

### 3. Background Scripts / Service Workers のセキュリティ
- **Message Passing**: `chrome.runtime.onMessage` のリスナーで sender の検証を行っているか
- **外部API通信**: HTTPS通信の使用、APIキーの安全な管理
- **認証情報**: トークンやAPIキーが適切に保護されているか（ハードコーディングされていないか）
- **クロスオリジンリクエスト**: 適切な origin 検証が行われているか

### 4. ストレージのセキュリティ
- **chrome.storage の使用**: 機密情報を平文で保存していないか
- **データ暗号化**: 必要に応じて暗号化が実施されているか
- **ストレージの同期**: `chrome.storage.sync` で機密情報を同期していないか
- **データの有効期限**: 不要になったデータを適切に削除しているか

### 5. 外部リソースとの通信
- **外部スクリプト**: 信頼できないCDNやサードパーティスクリプトの読み込みを避けているか
- **Subresource Integrity (SRI)**: 外部リソースにSRIハッシュを使用しているか
- **HTTPS強制**: すべての外部通信でHTTPSを使用しているか
- **CORS設定**: クロスオリジンリクエストが適切に制限されているか

### 6. インジェクション攻撃対策
- **SQLインジェクション**: データベース操作がある場合、適切にエスケープされているか
- **コマンドインジェクション**: 外部コマンド実行がある場合、入力検証が適切か
- **HTMLインジェクション**: ユーザー入力がHTMLに挿入される場合、適切にエスケープされているか

### 7. データ保護とプライバシー
- **個人情報の取り扱い**: 必要最小限のデータのみ収集しているか
- **データ送信**: ユーザーデータを外部に送信する場合、適切な同意を得ているか
- **ログ出力**: 機密情報がログに出力されていないか
- **クリップボードアクセス**: クリップボードの読み書きが適切に制限されているか

### 8. クロスサイトスクリプティング (XSS) 対策
- **Trusted Types**: 可能であればTrusted Types APIの使用
- **DOMPurify等の使用**: サニタイゼーションライブラリの適切な使用
- **動的コンテンツ**: `textContent` の使用を優先し、`innerHTML` は避ける

### 9. その他のセキュリティ考慮事項
- **依存関係**: 既知の脆弱性を持つライブラリを使用していないか
- **エラーハンドリング**: エラーメッセージで機密情報を漏洩していないか
- **デバッグコード**: 本番環境にデバッグコードやコンソールログが残っていないか
- **クリックジャッキング**: 適切なフレーム制御が行われているか

## レビュー方法

リポジトリのCLAUDE.mdを参照し、プロジェクト固有のスタイルと規約に従ってください。

検出された問題については：
- **Critical**: 即座に修正が必要なセキュリティ脆弱性
- **High**: 早急な対応が推奨される問題
- **Medium**: 改善が望ましい事項
- **Low**: 軽微な改善提案

上記の重要度を明記してください。

## デバッグ指示

レビューを開始する前に、以下の内容を明示的に出力してください：
1. **レビュー開始メッセージ**: 「セキュリティレビューを開始します」
2. **チェック対象のリスト**: 上記の9つの観点すべてを列挙

レビュー実施中は、各観点について以下の形式で結果を出力してください：
```
[観点名] チェック中...
- チェック項目1: ✓ OK / ⚠ 警告 / ✗ 問題あり
- チェック項目2: ✓ OK / ⚠ 警告 / ✗ 問題あり
...
```

最終的なレビュー結果をPRにコメントする前に、チェックリストのサマリーを出力してください：
```
=== セキュリティレビューサマリー ===
✓ 問題なし: X項目
⚠ 警告: Y項目
✗ 要対応: Z項目
合計チェック項目数: N項目
================================
```

レビュー結果は必ず日本語で、`gh pr comment` コマンドをBashツールで使用してPRにコメントとして投稿してください。
建設的で具体的なフィードバックを心がけてください。
